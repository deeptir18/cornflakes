### Experiment runner yaml for Scatter-Gather Bench

time: 10
programs:
    start_server:
        start: sudo LD_LIBRARY_PATH={cornflakes_dir}/cornflakes-libos/3rdparty/dpdk/install/lib/x86_64-linux-gnu  nice -n -19 taskset 0x1 {cornflakes_dir}/scatter-gather-bench/build/netperf -c 0xff -n 4 -w 0000:37:00.0 --proc-type=auto -- --mode=SERVER --ip={server_ip}{with_copy}
        hosts: [server]
        log:
            out: "{folder}/server.log"
            err: "{folder}/server.err.log"
            record: "{folder}/server.record.log"
        stop: sudo kill -9 `ps aux | grep {cornflakes_dir}/scatter-gather-bench/build/netperf | awk '{{print $2}}' | head -n4`
    start_client:
        start: sudo LD_LIBRARY_PATH={cornflakes_dir}/cornflakes-libos/3rdparty/dpdk/install/lib/x86_64-linux-gnu {cornflakes_dir}/scatter-gather-bench/build/netperf -c 0xff -n 4 -w 0000:37:00.0 --proc-type=auto -- --mode=CLIENT --server_ip={server_ip} --ip={host_ip} --server_mac={server_mac} --rate={rate} --segment_size={segment_size} --num_mbufs={num_mbufs} --time={time} --log={folder}/{host}.latency.log
        hosts: [client2, client1, client3, client4, client5, client6, client7, client8, client9, client10, client11]
        log:
            out: "{folder}/{host}.log"
            err: "{folder}/{host}.err.log"
            record: "{folder}/{host}.record.log"

commands:
    - program: start_server
      begin: 0

    - program: start_client
      begin: 3
